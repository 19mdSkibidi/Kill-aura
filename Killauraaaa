local http = request or http_request or syn.request
local whitelistedHWIDs = {}

local function getHWID()
    return game:GetService("RbxAnalyticsService"):GetClientId()
end

local function fetchHWIDTable()
    local res = http({
        Url = "https://raw.githubusercontent.com/19mdSkibidi/Hwid.txt/main/Hwid.txt",
        Method = "GET"
    })
    if res.StatusCode == 200 then
        for hwid in string.gmatch(res.Body, "[^\r\n]+") do
            table.insert(whitelistedHWIDs, hwid)
        end
    end
end

local function isWhitelisted()
    local hwid = getHWID()
    for _, v in ipairs(whitelistedHWIDs) do
        if v == hwid then
            return true
        end
    end
    return false
end

fetchHWIDTable()
if not isWhitelisted() then
    game.Players.LocalPlayer:Kick("Not Whitelisted")
    return
end

local target_plr = nil

local players = game:GetService("Players")
local user_input_service = game:GetService("UserInputService")
local run_service = game:GetService("RunService")

local local_player = players.LocalPlayer

local get_closest_to_mouse = function()
    local target = nil
    local max_distance = math.huge

    for _, plr in pairs(players:GetPlayers()) do
        if plr == local_player or not plr.Character or not plr.Character['HumanoidRootPart'] then continue end

        local pos = workspace.CurrentCamera:WorldToViewportPoint(plr.Character.HumanoidRootPart.Position)
        local magnitude = (Vector2.new(pos.X, pos.Y) - user_input_service:GetMouseLocation()).Magnitude

        if magnitude <= max_distance then
            target = plr
            max_distance = magnitude
        end
    end

    return target
end

run_service.Heartbeat:Connect(function()
    local args = {
    [1] = "ShootGun",
    [2] = game:GetService("Players").LocalPlayer.Character:FindFirstChildOfClass("Tool"):WaitForChild("Handle"),
    [3] = get_closest_to_mouse().Character.Head.Position,
    [4] = get_closest_to_mouse().Character.Head.Position,
    [5] = get_closest_to_mouse().Character.Head,
    [6] = Vector3.zAxis
}

game:GetService("Players").LocalPlayer.Character:FindFirstChildOfClass("Tool"):WaitForChild("RemoteEvent"):FireServer(unpack(args))

end)
